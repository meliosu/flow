import runtime;

import nemo;
import vm;

main() {
    src = "
        var x: int;
        var y: int;
        var arr: [int];
        {
            x := 0;
            y := 50;
            arr := [0];

            {{
                x := (x + 1);
                arr := upd(arr, x, x);
                x < y?;
            }}*
        }
    ";

    program = parseAst(src);

    println("nemo ast:");
    println(program);
    println("\n");

    if (isValidProgram(program)) {
        translated = translateProgram(program);

        println("vm:");
        println(translated);
        println("\n");

        println("vm (string):");
        println(vmProgram2s(translated));
        println("\n");

        vmProgramRun(translated, 500);
    } else {
        println("NeMo is invalid");
    }
}